<!DOCTYPE html>
<html lang="en-US">
  <head>
    <link href="/assets/index.css" rel="stylesheet" type="text/css" />
    <script crossorigin="anonymous" src="https://unpkg.com/react@16.8.6/umd/react.development.js"></script>
    <script crossorigin="anonymous" src="https://unpkg.com/react-dom@16.8.6/umd/react-dom.development.js"></script>
    <script crossorigin="anonymous" src="/test-harness.js"></script>
    <script crossorigin="anonymous" src="/test-page-object.js"></script>
    <script crossorigin="anonymous" src="/__dist__/webchat-es5.js"></script>
  </head>
  <body>
    <div>
      <main></main>
      <pre></pre>
    </div>
    <script>
      run(async function () {
        const { withEmoji } = WebChat;
        const Input = React.forwardRef((props, ref) => React.createElement('input', { ...props, ref }));
        const InputWithEmoji = withEmoji(Input);
        // const App = () => {
        //   const [value, setValue] = React.useState('');
        //   const handleChange = React.useCallback(event => setValue(event.currentTarget.value), [setValue]);

        //   return React.createElement(
        //     'label',
        //     {},
        //     'Input: ',
        //     React.createElement('input', {
        //       autoFocus: true,
        //       // emojiMap: new Map([]),
        //       onChange: handleChange,
        //       value
        //     })
        //   );
        // };

        const App = () => {
          const [value, setValue] = React.useState('');

          return React.createElement(
            'label',
            {},
            'Input: ',
            React.createElement(InputWithEmoji, {
              autoFocus: true,
              emojiMap: new Map([]),
              onChange: setValue,
              value
            })
          );
        };

        await new Promise(resolve =>
          ReactDOM.render(React.createElement(App), document.getElementsByTagName('main')[0], resolve)
        );

        const [inputElement] = document.getElementsByTagName('input');

        expect(inputElement.value).toBe('');

        return;

        await host.sendKeys('Hello!');
        expect(inputElement.value).toBe('Hello!');
        expect(inputElement.selectionStart).toBe(6);
        expect(inputElement.selectionEnd).toBe(6);

        await host.sendKeys('LEFT', 'LEFT', 'DELETE', 'DELETE', 'BACK_SPACE', 'BACK_SPACE');
        expect(inputElement.value).toBe('He');

        await host.sendKeys('+CONTROL', 'Z', '-CONTROL');
        expect(inputElement.value).toBe('Hell');

        await host.sendKeys('+CONTROL', 'Z', '-CONTROL');
        expect(inputElement.value).toBe('Hello!');

        await host.sendKeys('+CONTROL', 'Z', '-CONTROL');
        expect(inputElement.value).toBe('');

        await host.sendKeys('ABC', 'HOME', '123');
        expect(inputElement.value).toBe('123ABC');

        await host.sendKeys('+CONTROL', 'Z', '-CONTROL');
        expect(inputElement.value).toBe('ABC');
        expect(inputElement.selectionStart).toBe(0);
        expect(inputElement.selectionEnd).toBe(0);

        await host.sendKeys('+CONTROL', 'Z', '-CONTROL');
        expect(inputElement.value).toBe('');
        expect(inputElement.selectionStart).toBe(0);
        expect(inputElement.selectionEnd).toBe(0);
      });
    </script>
  </body>
</html>
