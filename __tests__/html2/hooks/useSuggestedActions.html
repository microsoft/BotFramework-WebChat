<!doctype html>
<html lang="en-US">
  <head>
    <link href="/assets/index.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <main id="webchat"></main>
    <script type="importmap">
      {
        "imports": {
          "botframework-webchat": "/__dist__/packages/bundle/static/botframework-webchat.js",
          "botframework-webchat/component": "/__dist__/packages/bundle/static/botframework-webchat/component.js",
          "botframework-webchat/hook": "/__dist__/packages/bundle/static/botframework-webchat/hook.js",
          "react": "https://esm.sh/react@18",
          "react-dom": "https://esm.sh/react-dom@18",
          "react-dom/": "https://esm.sh/react-dom@18/"
        }
      }
    </script>
    <script type="module">
      import '/test-harness.mjs';
      import '/test-page-object.mjs';

      import { createDirectLine, createStoreWithOptions, testIds } from 'botframework-webchat';
      import { useSuggestedActions } from 'botframework-webchat/hook';
      import createRenderHook from '/assets/esm/createRenderHook.js';

      const {
        createStore,
        token: { fetchDirectLineToken }
      } = window.testHelpers;

      window.WebChat = { createStoreWithOptions, testIds };

      run(async function () {
        const renderHook = createRenderHook(
          document.getElementById('webchat'),
          { directLine: createDirectLine({ token: await fetchDirectLineToken() }), store: createStore() },
          { renderWebChat: true }
        );

        await renderHook();

        await pageConditions.uiConnected();

        await pageObjects.sendMessageViaSendBox('suggested-actions');

        await pageConditions.numActivitiesShown(2);
        await pageConditions.suggestedActionsShown();

        const [suggestedActions] = await renderHook(() => useSuggestedActions());

        expect(suggestedActions).toEqual([
          {
            type: 'imBack',
            title: 'IM back as string',
            image: 'https://hawo-mockbot4-mock-bot-app.azurewebsites.net/assets/square-icon-U3PTSB2G.png',
            imageAltText: 'a blue square',
            value: 'postback imback-string'
          },
          {
            type: 'postBack',
            title: 'Post back as string',
            image: 'https://hawo-mockbot4-mock-bot-app.azurewebsites.net/assets/square-icon-red-NTYZI5EO.png',
            imageAltText: 'a red square',
            value: 'postback postback-string'
          },
          {
            type: 'postBack',
            title: 'Post back as JSON',
            image: 'https://hawo-mockbot4-mock-bot-app.azurewebsites.net/assets/square-icon-green-FUFF53XL.png',
            imageAltText: 'a green square',
            text: 'Some text',
            value: {
              hello: 'World!'
            }
          },
          {
            type: 'messageBack',
            title: 'Message back as JSON with display text',
            image: 'https://hawo-mockbot4-mock-bot-app.azurewebsites.net/assets/square-icon-purple-G7EQE7UG.png',
            imageAltText: 'a purple square',
            text: 'Some text',
            displayText: 'say Hello World!',
            value: {
              hello: 'World!'
            }
          },
          {
            type: 'messageBack',
            title: 'Message back as JSON without display text',
            image: 'https://hawo-mockbot4-mock-bot-app.azurewebsites.net/assets/square-icon-purple-G7EQE7UG.png',
            imageAltText: 'a purple square',
            value: {
              hello: 'World!'
            }
          },
          {
            type: 'messageBack',
            title: 'Message back as string with display text',
            image: 'https://hawo-mockbot4-mock-bot-app.azurewebsites.net/assets/square-icon-purple-G7EQE7UG.png',
            imageAltText: 'a purple square',
            text: 'echo Hello',
            displayText: 'Aloha'
          }
        ]);
      });
    </script>
  </body>
</html>
